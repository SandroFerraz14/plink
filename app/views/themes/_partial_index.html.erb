<div class="panel blank-panel">
  <div class="panel-heading">
    <div class="panel-options">
      
      <ul class="nav nav-tabs">
        <% @themes.each do |theme| %>
           <li class="<%= (@themes.first == theme) ? "active" : "" %>">
              <a data-toggle="tab" href="#tab-<%= theme.id %>" class=""><%= theme.name %></a>
              <% if (@themes.first != theme) %>
                <%= link_to theme,  class: "absolute-top-right remove-button", method: :delete, data: { confirm: 'Are you sure?' } do %>X<% end %>
              <% end %>
              <a href="#" alt="Update theme ideas" title="Update theme ideas" type="button" class="btn btn-default glyphicon glyphicon-save-file" onclick="updateThemeIdeas(<%= theme.id %>);"><%= theme.name %></a>
           </li>
        <% end %>
        <li>
          <%= render 'themes/form' %>
           <%= button_tag(type: "button", onclick: "showFormTopic();", class: "btn btn-primary pull-left add-item") do %>
            <i class="glyphicon glyphicon-plus"></i>
          <% end %>
        </li>
      </ul>
    </div>
  </div>
  <div class="panel-body">
    <div class="tab-content">
      <% @themes.each do |theme| %>
        <div id="tab-<%= theme.id %>" class="tab-pane <%= (@themes.first == theme) ? "active" : "" %>">
          <%= form_for update_theme_ideas_ideas_path, :html => {:id => "selected-ideas"}, method: :get do %>
            <% theme.ideas.each do |idea| %>
              <%= render partial: "ideas/idea", object: idea %>
            <% end %>
            <%= hidden_field_tag "id_theme" %>
          <% end %>
        </div>
        
            
      <% end %>
      
    </div>
  </div>
</div>
<script type="text/javascript">
  var showFormTopic = function(){
    $(".new_theme").show();
  }
  function updateThemeIdeas(themeId) {
    $("#id_theme").val(themeId);
    var form = $("#selected-ideas");
    $.ajax({
      type: "GET",
      url: "/ideas/update_theme_ideas",
      dataType: "json",
      traditional: true,
      data: form.serialize(),
      success: function(data){
        console.log(data[0].message);
      }
    });
  }
</script>

